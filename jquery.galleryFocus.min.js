(function($){var global={o:{},e:[],mouse:{},overlay:null};var defaults={radius:400,fadeTo:0.2,invert:false,overlay:false};var methods={init:function(options){global.o=$.extend(defaults,options);this.each(function(i,el){global.e[i]={el:$(el),opacity:1,pos:{}};var p=global.e[i].el.offset();global.e[i].pos.left=p.left;global.e[i].pos.top=p.top;global.e[i].pos.width=global.e[i].el.outerWidth();global.e[i].pos.height=global.e[i].el.outerHeight();global.e[i].pos.right=Math.floor(p.left+global.e[i].pos.width);global.e[i].pos.bottom=Math.floor(p.top+global.e[i].pos.height);global.e[i].pos.x=Math.floor(p.left+(global.e[i].pos.width/2));global.e[i].pos.y=Math.floor(p.top+(global.e[i].pos.height/2))});$(document).mousemove(function(c){calculateMouse(c);$.each(global.e,function(i,el){if(!testInBox(el)){if(global.o.invert){setOpacity(el,1)}else{setOpacity(el,global.o.fadeTo)}return true}var length=distance(mouse,el.pos);var opacity=global.o.fadeTo;if(global.o.invert){opacity=toFloat(percentOf(length,global.o.radius))}else{opacity=toFloat(invertPercent(percentOf(length,global.o.radius)))}if(opacity<global.o.fadeTo){opacity=global.o.fadeTo}setOpacity(el,opacity)})});var createOverlay=function(){var style={position:"absolute",top:0,left:0,width:0,height:0,"z-index":999,"-moz-border-radius":"1000px","-webkit-border-radius":"1000px","-khtml-border-radius":"1000px","border-radius":"1000px",border:"2px solid rgba(80, 80, 80, 0.30)","pointer-events":"none"};$('<div id="gallery-focus-radius">').css(style).appendTo("body");global.overlay=$("#gallery-focus-radius")};var testInBox=function(el){var p=el.pos;if(p.left<mouse.left||p.top<mouse.top||p.right>mouse.right||p.bottom>mouse.bottom){return false}return true};var percentOf=function(a,b){return Math.floor((a/b)*100)};var toFloat=function(num){return(num/100)};var invertPercent=function(num){return(100-num)};var distance=function(p,q){var dx=p.x-q.x;var dy=p.y-q.y;var dist=Math.sqrt(dx*dx+dy*dy);return dist};var setOpacity=function(element,value){element.opacity=value;element.el.css("opacity",value)};var calculateMouse=function(e){mouse={x:e.pageX,y:e.pageY,left:e.pageX-global.o.radius,top:e.pageY-global.o.radius,right:e.pageX+global.o.radius,bottom:e.pageY+global.o.radius};if(global.o.overlay){if(global.overlay==null){createOverlay()}global.overlay.css({top:mouse.top,left:mouse.left,width:global.o.radius*2,height:global.o.radius*2})}}},overlay:function(value){global.o.overlay=value;if(value==false){global.overlay.hide()}else{if(global.overlay!=null){global.overlay.show()}}},set:function(key,value){if(typeof global.o[key]!="undefined"){global.o[key]=value}},get:function(key){if(typeof global.o[key]!="undefined"){return global.o[key]}}};$.fn.galleryFocus=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}else{$.error("Method "+method+" does not exist on jQuery.galleryFocus")}}}})(jQuery);